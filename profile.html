<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>ä¸ªäººä¿¡æ¯ - æˆç»©ç®¡ç†ç³»ç»Ÿ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --primary-color: #3498db;
      --primary-dark: #2980b9;
      --secondary-color: #2c3e50;
      --accent-color: #2ecc71;
      --light-gray: #f8f9fa;
      --medium-gray: #e9ecef;
      --dark-gray: #6c757d;
      --danger-color: #e74c3c;
      --border-radius: 8px;
      --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      color: var(--secondary-color);
      line-height: 1.6;
      padding: 20px;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    /* å¤´éƒ¨æ ·å¼ */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 20px 30px;
      margin-bottom: 25px;
    }
    
    .header h1 {
      font-size: 28px;
      font-weight: 600;
      color: var(--secondary-color);
      display: flex;
      align-items: center;
    }
    
    .header h1:before {
      content: "ğŸ‘¤";
      margin-right: 12px;
      font-size: 32px;
    }
    
    .btn-back {
      padding: 10px 20px;
      background: var(--dark-gray);
      color: white;
      text-decoration: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      transition: var(--transition);
      display: flex;
      align-items: center;
    }
    
    .btn-back:hover {
      background: #5a6268;
      transform: translateX(-3px);
    }
    
    /* ä¸ªäººä¿¡æ¯å¡ç‰‡ */
    .profile-card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 30px;
      margin-bottom: 25px;
      overflow: hidden;
    }
    
    .profile-header {
      display: flex;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--medium-gray);
    }
    
    .profile-avatar {
      width: 100px;
      height: 100px;
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 25px;
      color: white;
      font-size: 40px;
    }
    
    .profile-info h2 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .profile-info p {
      color: var(--dark-gray);
      font-size: 16px;
    }
    
    .role-badge {
      display: inline-block;
      padding: 4px 12px;
      background: var(--accent-color);
      color: white;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
      margin-top: 8px;
    }
    
    .role-badge.teacher {
      background: var(--primary-color);
    }
    
    /* ä¿¡æ¯è¯¦æƒ… */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }
    
    .info-item {
      padding: 15px;
      background: var(--light-gray);
      border-radius: var(--border-radius);
      transition: var(--transition);
    }
    
    .info-item:hover {
      background: rgba(52, 152, 219, 0.05);
      transform: translateY(-2px);
    }
    
    .info-label {
      font-size: 14px;
      color: var(--dark-gray);
      margin-bottom: 5px;
    }
    
    .info-value {
      font-size: 18px;
      font-weight: 500;
      color: var(--secondary-color);
    }
    
    /* åŠ è½½å’Œé”™è¯¯çŠ¶æ€ */
    .loading {
      text-align: center;
      padding: 40px 20px;
      color: var(--dark-gray);
    }
    
    .loading-spinner {
      display: inline-block;
      width: 30px;
      height: 30px;
      border: 3px solid rgba(52, 152, 219, 0.3);
      border-radius: 50%;
      border-top-color: var(--primary-color);
      animation: spin 1s ease-in-out infinite;
      margin-bottom: 15px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .error-message {
      background: rgba(231, 76, 60, 0.1);
      color: var(--danger-color);
      padding: 15px;
      border-radius: var(--border-radius);
      text-align: center;
      margin-bottom: 20px;
    }
    
    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
        padding: 20px;
      }
      
      .header h1 {
        margin-bottom: 15px;
      }
      
      .profile-header {
        flex-direction: column;
        text-align: center;
      }
      
      .profile-avatar {
        margin-right: 0;
        margin-bottom: 15px;
      }
      
      .info-grid {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 15px;
      }
      
      .container {
        padding: 0;
      }
      
      .header h1 {
        font-size: 24px;
      }
      
      .profile-card {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ä¸ªäººä¿¡æ¯</h1>
      <a href="student.html" class="btn-back">â† è¿”å›å­¦ç”Ÿä¸»é¡µ</a>
    </div>
    
    <div id="profile-card" class="profile-card">
      <div id="loading" class="loading">
        <div class="loading-spinner"></div>
        <p>æ­£åœ¨åŠ è½½ä¸ªäººä¿¡æ¯...</p>
      </div>
      
      <div id="error-message" class="error-message" style="display: none;"></div>
      
      <div id="profile-content" style="display: none;">
        <div class="profile-header">
          <div class="profile-avatar">
            <span id="avatar-icon">ğŸ‘¤</span>
          </div>
          <div class="profile-info">
            <h2 id="user-name">åŠ è½½ä¸­...</h2>
            <p id="user-id">å­¦å·: åŠ è½½ä¸­...</p>
            <div id="role-badge" class="role-badge">å­¦ç”Ÿ</div>
          </div>
        </div>
        
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">å­¦å·</div>
            <div class="info-value" id="info-id">-</div>
          </div>
          
          <div class="info-item">
            <div class="info-label">å§“å</div>
            <div class="info-value" id="info-name">-</div>
          </div>
          
          <div class="info-item">
            <div class="info-label">ç­çº§</div>
            <div class="info-value" id="info-class">-</div>
          </div>
          
          <div class="info-item">
            <div class="info-label">è§’è‰²</div>
            <div class="info-value" id="info-role">-</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // è·å–ç”¨æˆ·ä¿¡æ¯
    async function fetchProfile() {
      const user = JSON.parse(localStorage.getItem('user'));
      if (!user) {
        alert('è¯·å…ˆç™»å½•ï¼');
        window.location.href = 'index.html';
        return;
      }

      const loadingEl = document.getElementById('loading');
      const errorEl = document.getElementById('error-message');
      const contentEl = document.getElementById('profile-content');

      try {
        loadingEl.style.display = 'block';
        errorEl.style.display = 'none';
        contentEl.style.display = 'none';

        const response = await fetch('https://b9vwa2nxmd.execute-api.us-east-1.amazonaws.com/beg/profile', {
          method: 'GET',
          headers: {
            'X-User-ID': user.id
          }
        });

        const data = await response.json();

        if (data.success) {
          const p = data.data;
          
          // æ›´æ–°é¡µé¢å†…å®¹
          document.getElementById('user-name').textContent = p.name;
          document.getElementById('user-id').textContent = `å­¦å·: ${p.id}`;
          document.getElementById('info-id').textContent = p.id;
          document.getElementById('info-name').textContent = p.name;
          document.getElementById('info-class').textContent = p.class || 'æœªåˆ†é…';
          document.getElementById('info-role').textContent = p.role === 'student' ? 'å­¦ç”Ÿ' : 'æ•™å¸ˆ';
          
          // æ›´æ–°è§’è‰²å¾½ç« 
          const roleBadge = document.getElementById('role-badge');
          roleBadge.textContent = p.role === 'student' ? 'å­¦ç”Ÿ' : 'æ•™å¸ˆ';
          if (p.role === 'teacher') {
            roleBadge.classList.add('teacher');
            document.getElementById('avatar-icon').textContent = 'ğŸ‘¨â€ğŸ«';
          }
          
          // æ˜¾ç¤ºå†…å®¹
          loadingEl.style.display = 'none';
          contentEl.style.display = 'block';
        } else {
          throw new Error(data.message || 'è·å–ä¿¡æ¯å¤±è´¥');
        }
      } catch (err) {
        console.error('Fetch error:', err);
        loadingEl.style.display = 'none';
        errorEl.style.display = 'block';
        errorEl.textContent = `âŒ ${err.message || 'ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•'}`;
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆåè·å–ä¸ªäººä¿¡æ¯
    window.addEventListener('DOMContentLoaded', fetchProfile);
    
    // æ·»åŠ é¡µé¢åŠ è½½åŠ¨ç”»
    window.addEventListener('load', function() {
      document.body.style.opacity = 0;
      document.body.style.transition = 'opacity 0.5s ease';
      
      setTimeout(function() {
        document.body.style.opacity = 1;
      }, 100);
    });
  </script>
</body>
</html>
